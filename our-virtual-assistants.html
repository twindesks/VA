<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VA Needs Assessment | TwinDesk</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'td-primary': '#3f9dd1', 'td-secondary': '#66aedd', 'td-pink': '#f27ea9', 'td-orange': '#faaf20', 'td-light-orange': '#ffdf99',
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                },
            },
        }
    </script>
    
    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fb; }
        .task-item {
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            padding: 10px 0;
            transition: background-color 0.2s;
            border-bottom: 1px dashed #e5e7eb;
        }
        .task-item:last-child {
            border-bottom: none;
        }
        .task-item:hover {
            background-color: #f7f9fb;
        }
        .task-item input[type="checkbox"] {
            margin-right: 12px;
            min-width: 1.25rem;
            min-height: 1.25rem;
            accent-color: var(--td-primary);
            margin-top: 3px;
        }
        .task-category-heading {
            font-weight: 800;
            color: #1f2937;
            margin-top: 2rem;
            margin-bottom: 0.5rem;
            border-left: 5px solid #faaf20;
            padding-left: 10px;
        }
        .task-category-heading:first-child {
            margin-top: 0;
        }
        .other-task-input {
            margin-left: 8px; 
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 80%;
            font-size: 0.875rem;
        }
        /* Custom styles for embedded calendar section */
        #calendar-embed-container {
            border-top: 1px solid #ddd;
            padding-top: 2rem;
            margin-top: 2rem;
        }
        /* Style for the Calendly widget itself */
        .calendly-inline-widget {
             /* Reduced height for "mini" look */
            height: 550px !important; 
        }
    </style>
</head>

<body>

    <header class="bg-white sticky top-0 z-50 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="index.html" title="TwinDesk Homepage" class="flex items-center">
                <img src="https://live.staticflickr.com/65535/54901201395_a052e1f973_b.jpg" alt="TwinDesk Logo" class="h-20 w-auto md:h-24"/>
            </a>
            <nav class="hidden md:flex space-x-6 lg:space-x-8">
                <a href="index.html" class="text-gray-600 hover:text-td-primary font-medium transition duration-300">Home</a>
                <a href="our-virtual-assistants.html" class="text-td-primary font-bold transition duration-300">VA Assessment</a>
                <a href="va-matching-process.html" class="text-gray-600 hover:text-td-primary font-medium transition duration-300">VA Matching Process</a>
                <a href="index.html#team" class="text-gray-600 hover:text-td-primary font-medium transition duration-300">Team</a>
                <a href="index.html#faq" class="text-gray-600 hover:text-td-primary font-medium transition duration-300">FAQ</a>
            </nav>
            <a href="https://calendly.com/info-twindesk/30min?month=2025-11" class="bg-td-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-td-secondary transition duration-300 shadow-md" target="_blank">Schedule Call</a>
        </div>
    </header>

    <main>
        <a href="https://wa.me/639054401660" target="_blank" class="fixed bottom-8 right-8 z-[100] bg-[#25D366] text-white px-6 py-3 rounded-full shadow-2xl hover:scale-105 transition-transform duration-300 flex items-center gap-3 border-2 border-white group animate-bounce hover:animate-none">
            <i data-lucide="message-circle" class="w-6 h-6 fill-white text-[#25D366]"></i> 
            <span class="font-bold text-lg tracking-wide">Let's Chat</span>
        </a>

        <section class="bg-td-secondary/10 pt-16 pb-20 border-b-4 border-td-primary">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 leading-tight mb-4">Find Your Perfect VA Match</h1>
                <p class="mt-4 text-xl text-gray-600 max-w-3xl mx-auto">Check the tasks you need help with to receive an instant VA recommendation.</p>
            </div>
        </section>

        <section class="py-20 bg-white">
            <form id="va-assessment-form" action="https://formspree.io/f/xnnokzez" method="POST" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid lg:grid-cols-2 gap-10">
                    
                    <div class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100 lg:col-span-1">
                        <h2 class="text-3xl font-extrabold text-gray-900 mb-8 text-center">Which tasks take up your time?</h2>
                        <div id="task-checklist" class="space-y-2">
                            
                            <h3 class="task-category-heading text-xl">General Administrative & Operations</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="7" data-category="Admin" name="task[]" value="Admin: Organize & respond to emails" class="task-checkbox">
                                <span class="text-gray-700 text-base">Organize & respond to emails, flagging important messages</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="Admin" name="task[]" value="Admin: Schedule appointments, meetings, and reminders" class="task-checkbox">
                                <span class="text-gray-700 text-base">Schedule appointments, meetings, and reminders</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="Admin" name="task[]" value="Admin: Data entry & maintain digital filing systems" class="task-checkbox">
                                <span class="text-gray-700 text-base">Data entry & maintain digital filing systems</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="4" data-category="Admin" name="task[]" value="Admin: Track payments, process invoices, and manage receipts" class="task-checkbox">
                                <span class="text-gray-700 text-base">Track payments, process invoices, and manage receipts</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="3" data-category="Admin" name="task[]" value="Admin: Help with creating SOPs, guides, or checklists" class="task-checkbox">
                                <span class="text-gray-700 text-base">Help with creating SOPs, guides, or checklists</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="Admin" name="task[]" value="Admin: Perform light research and assist with online tasks" class="task-checkbox">
                                <span class="text-gray-700 text-base">Perform light research and assist with online tasks</span>
                            </label>

                            <h3 class="task-category-heading text-xl">Bookkeeping & Accounts Receivable</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="Bookkeeping" name="task[]" value="Bookkeeping: Record daily AR transactions & reconcile customer payments" class="task-checkbox">
                                <span class="text-gray-700 text-base">Record daily AR transactions & reconcile customer payments</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="4" data-category="Bookkeeping" name="task[]" value="Bookkeeping: Prepare and send out invoices and account statements" class="task-checkbox">
                                <span class="text-gray-700 text-base">Prepare and send out invoices and account statements</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="6" data-category="Bookkeeping" name="task[]" value="Bookkeeping: Monitor aging reports and follow up on overdue accounts" class="task-checkbox">
                                <span class="text-gray-700 text-base">Monitor aging reports and follow up on overdue accounts</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="Bookkeeping" name="task[]" value="Bookkeeping: Maintain accurate financial records in QuickBooks" class="task-checkbox">
                                <span class="text-gray-700 text-base">Maintain accurate financial records in QuickBooks</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="3" data-category="Bookkeeping" name="task[]" value="Bookkeeping: Communicate with clients regarding billing inquiries" class="task-checkbox">
                                <span class="text-gray-700 text-base">Communicate with clients regarding billing inquiries</span>
                            </label>

                            <h3 class="task-category-heading text-xl">Customer Service & Sales Support</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="20" data-category="Customer Service" name="task[]" value="Customer Service: Handle support tickets/live chat/client inquiries professionally" class="task-checkbox">
                                <span class="text-gray-700 text-base">Handle support tickets/live chat/client inquiries professionally</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="6" data-category="Customer Service" name="task[]" value="Customer Service: Follow up with leads and manage CRM data/updates" class="task-checkbox">
                                <span class="text-gray-700 text-base">Follow up with leads and manage CRM data/updates</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="10" data-category="Customer Service" name="task[]" value="Customer Service: Outbound calls/appointment setting" class="task-checkbox">
                                <span class="text-gray-700 text-base">Outbound calls/appointment setting</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="3" data-category="Customer Service" name="task[]" value="Customer Service: Process warranty/refund requests" class="task-checkbox">
                                <span class="text-gray-700 text-base">Process warranty/refund requests</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="4" data-category="Customer Service" name="task[]" value="Customer Service: Conduct customer satisfaction surveys/follow-up" class="task-checkbox">
                                <span class="text-gray-700 text-base">Conduct customer satisfaction surveys/follow-up</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="Customer Service" name="task[]" value="Customer Service: Perform outbound calls for service reviews" class="task-checkbox">
                                <span class="text-gray-700 text-base">Perform outbound calls for service reviews</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="3" data-category="Customer Service" name="task[]" value="Customer Service: Manage and update help center/knowledge base articles" class="task-checkbox">
                                <span class="text-gray-700 text-base">Manage and update help center/knowledge base articles</span>
                            </label>
                            
                            <h3 class="task-category-heading text-xl">Design & Branding</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="10" data-category="Design" name="task[]" value="Design: Create social media graphics, ads, and banners" class="task-checkbox">
                                <span class="text-gray-700 text-base">Create social media graphics, ads, and banners (Photoshop/Canva)</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="Design" name="task[]" value="Design: Design/layout e-books, white papers, or detailed print materials" class="task-checkbox">
                                <span class="text-gray-700 text-base">Design/layout e-books, white papers, or detailed print materials</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="6" data-category="Design" name="task[]" value="Design: Edit photos, product images, and perform light video editing" class="task-checkbox">
                                <span class="text-gray-700 text-base">Edit photos, product images, and perform light video editing</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="2" data-category="Design" name="task[]" value="Design: Ensure all visual assets adhere to brand guidelines and standards" class="task-checkbox">
                                <span class="text-gray-700 text-base">Ensure all visual assets adhere to brand guidelines and standards</span>
                            </label>

                            <h3 class="task-category-heading text-xl">Marketing & Social Media</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="Marketing" name="task[]" value="Marketing: Social media content scheduling & content calendar creation" class="task-checkbox">
                                <span class="text-gray-700 text-base">Social media content scheduling & content calendar creation</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="6" data-category="Marketing" name="task[]" value="Marketing: Email marketing support (drafts, scheduling, list management)" class="task-checkbox">
                                <span class="text-gray-700 text-base">Email marketing support (drafts, scheduling, list management)</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="Marketing" name="task[]" value="Marketing: Simple graphic/video creation" class="task-checkbox">
                                <span class="text-gray-700 text-base">Simple graphic/video creation (Canva, Filmora, etc.)</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="4" data-category="Marketing" name="task[]" value="Marketing: Respond to comments, messages, and monitor brand conversations" class="task-checkbox">
                                <span class="text-gray-700 text-base">Respond to comments, messages, and monitor brand conversations</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="Marketing" name="task[]" value="Marketing: Track performance metrics & reporting" class="task-checkbox">
                                <span class="text-gray-700 text-base">Track performance metrics (reach, engagement) & reporting</span>
                            </label>

                            <h3 class="task-category-heading text-xl">Executive & High-Level Support</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="15" data-category="Executive" name="task[]" value="Executive: Manage complex calendars & prioritize/draft high-level emails" class="task-checkbox">
                                <span class="text-gray-700 text-base">Manage complex calendars & prioritize/draft high-level emails</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="6" data-category="Executive" name="task[]" value="Executive: Prepare meeting agendas, notes, and strategic follow-ups" class="task-checkbox">
                                <span class="text-gray-700 text-base">Prepare meeting agendas, notes, and strategic follow-ups</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="Executive" name="task[]" value="Executive: Liaise with internal teams/partners on executive's behalf" class="task-checkbox">
                                <span class="text-gray-700 text-base">Liaise with internal teams/partners on executive's behalf</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="10" data-category="Executive" name="task[]" value="Executive: Handle confidential info & provide proactive support" class="task-checkbox">
                                <span class="text-gray-700 text-base">Handle confidential info & provide proactive support</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="Executive" name="task[]" value="Executive: Prepare quarterly/monthly performance reports and presentations" class="task-checkbox">
                                <span class="text-gray-700 text-base">Prepare quarterly/monthly performance reports and presentations</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="10" data-category="Executive" name="task[]" value="Executive: Manage and track executive-level projects/OKRs" class="task-checkbox">
                                <span class="text-gray-700 text-base">Manage and track executive-level projects/OKRs</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="4" data-category="Executive" name="task[]" value="Executive: Coordinate complex travel arrangements and itineraries" class="task-checkbox">
                                <span class="text-gray-700 text-base">Coordinate complex travel arrangements and itineraries</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="3" data-category="Executive" name="task[]" value="Executive: Filter, prioritize, and manage CEO/Executive social media inbox" class="task-checkbox">
                                <span class="text-gray-700 text-base">Filter, prioritize, and manage CEO/Executive social media inbox</span>
                            </label>
                            
                            <h3 class="task-category-heading text-xl">E-commerce Management</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="6" data-category="E-commerce" name="task[]" value="E-commerce: Upload/update product listings (SKUs, pricing, images)" class="task-checkbox">
                                <span class="text-gray-700 text-base">Upload/update product listings (SKUs, pricing, images)</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="E-commerce" name="task[]" value="E-commerce: Write SEO-friendly product titles and descriptions" class="task-checkbox">
                                <span class="text-gray-700 text-base">Write SEO-friendly product titles and descriptions</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="10" data-category="E-commerce" name="task[]" value="E-commerce: Process, track, and fulfill orders & manage returns/refunds" class="task-checkbox">
                                <span class="text-gray-700 text-base">Process, track, and fulfill orders & manage returns/refunds</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="E-commerce" name="task[]" value="E-commerce: Store maintenance & performance monitoring/reports" class="task-checkbox">
                                <span class="text-gray-700 text-base">Store maintenance & performance monitoring/reports</span>
                            </label>
                            
                            <h3 class="task-category-heading text-xl">Web Development & Technical</h3>
                            <label class="task-item">
                                <input type="checkbox" data-hours="8" data-category="WebDev" name="task[]" value="WebDev: Perform minor website updates, bug fixes, and maintenance" class="task-checkbox">
                                <span class="text-gray-700 text-base">Perform minor website updates, bug fixes, and maintenance (HTML/CSS/JS)</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="WebDev" name="task[]" value="WebDev: Manage and update content on WordPress/Shopify platforms" class="task-checkbox">
                                <span class="text-gray-700 text-base">Manage and update content on WordPress/Shopify platforms</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="3" data-category="WebDev" name="task[]" value="WebDev: Check website responsiveness, load speed, and SEO basics" class="task-checkbox">
                                <span class="text-gray-700 text-base">Check website responsiveness, load speed, and SEO basics</span>
                            </label>
                            <label class="task-item">
                                <input type="checkbox" data-hours="5" data-category="WebDev" name="task[]" value="WebDev: Set up and integrate new web tools, forms, or plugins" class="task-checkbox">
                                <span class="text-gray-700 text-base">Set up and integrate new web tools, forms, or plugins</span>
                            </label>

                            <h3 class="task-category-heading text-xl">Other Tasks</h3>
                            <label class="task-item block">
                                <input type="checkbox" data-hours="5" data-category="Admin" name="task[]" value="Admin: Other tasks (see next field)" class="task-checkbox flex-shrink-0" id="other-task-checkbox">
                                <span class="text-gray-700 text-base flex items-center w-full">
                                    Others (Please specify): 
                                    <input type="text" placeholder="e.g., Run errands, software setup, etc." class="other-task-input text-sm" name="Other_Tasks_Details">
                                </span>
                            </label>

                            <h3 class="task-category-heading text-xl mt-8">Your Contact Information</h3>
                            <div class="space-y-4">
                                <input type="email" name="Email" placeholder="Your Email Address (Required)" required class="w-full p-3 border border-gray-300 rounded-lg focus:border-td-primary" />
                            </div>

                        </div>
                    </div>
                    
                    <div class="lg:col-span-1">
                         <div class="bg-td-light-orange/50 p-8 rounded-2xl border-4 border-td-orange shadow-2xl sticky top-28">
                            <h2 class="text-3xl font-extrabold text-gray-900 mb-6 text-center">ðŸ“‹ Your VA Recommendation</h2>
                            <div class="grid md:grid-cols-3 gap-6 text-center">
                                <div class="p-4 bg-white rounded-xl shadow-md border-b-4 border-td-primary md:col-span-3">
                                    <h3 class="text-lg font-semibold text-gray-600">Total Estimated Hours Needed</h3>
                                    <p id="total-hours" class="text-5xl font-extrabold text-td-primary mt-2">0</p>
                                    <p class="text-sm text-gray-500">hours / week</p>
                                </div>
                                <div class="p-4 bg-white rounded-xl shadow-md border-b-4 border-td-secondary md:col-span-3">
                                    <h3 class="text-lg font-semibold text-gray-600">Recommended Commitment</h3>
                                    <p id="va-commitment" class="text-3xl font-bold text-gray-400 mt-4">N/A</p>
                                    <p class="text-sm text-gray-500">(Part-Time: 10-29 hrs | Full-Time: 30+ hrs)</p>
                                </div>
                                <div class="p-4 bg-white rounded-xl shadow-md border-b-4 border-td-orange md:col-span-3">
                                    <h3 class="text-lg font-semibold text-gray-600">Suggested VA Type</h3>
                                    <p id="va-type" class="text-3xl font-bold text-gray-400 mt-4">N/A</p>
                                    <p class="text-sm text-gray-500">(Based on your top task category)</p>
                                </div>
                            </div>
                            
                            <input type="hidden" id="summary-report-input" name="Summary_Report" value="">

                            <div class="mt-8 text-center">
                                <button type="submit" class="w-full bg-td-pink text-white text-xl font-bold px-10 py-4 rounded-xl shadow-2xl hover:bg-td-primary transition duration-300 transform hover:scale-105">
                                    Send My VA Recommendation & Get Started
                                </button>
                            </div>
                            
                            <div id="calendar-embed-container">
                                <h3 class="text-xl font-extrabold text-gray-900 mb-4 text-center">Book Your 30-Min Call to get started</h3>
                                
                                <div class="calendly-inline-widget" data-url="https://calendly.com/info-twindesk/30min?month=2025-11&hide_event_type_details=1&hide_landing_page_details=1" style="min-width:320px;height:550px;"></div>
                                
                            </div>
                            </div>
                    </div>
                </div>

            </form>
        </section>
        
    </main>

    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center">
            <div class="mb-4 md:mb-0"><img src="https://live.staticflickr.com/65535/54901201395_a052e1f973_b.jpg" alt="TwinDesk Logo" class="h-12 w-auto grayscale opacity-70 hover:grayscale-0 hover:opacity-100 transition duration-300"/></div>
            <nav class="flex flex-wrap justify-center gap-6 mb-4 md:mb-0">
                <a href="index.html" class="text-gray-400 hover:text-white transition duration-300">Home</a>
                <a href="our-virtual-assistants.html" class="text-white font-semibold transition duration-300">VA Assessment</a>
                <a href="va-matching-process.html" class="text-gray-400 hover:text-white transition duration-300">VA Matching Process</a>
                <a href="index.html#team" class="text-gray-400 hover:text-white transition duration-300">Team</a>
                <a href="index.html#faq" class="text-gray-400 hover:text-white transition duration-300">FAQ</a>
            </nav>
            <div class="text-gray-400 text-sm">&copy; 2024 TwinDesk. All rights reserved.</div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();

            // Mappings 
            const vaTypeMapping = {
                'Admin': 'Administrative Assistant',
                'Bookkeeping': 'Bookkeeper / AR Specialist', 
                'Customer Service': 'Customer Service VA',
                'Design': 'Graphic Designer',
                'Marketing': 'Marketing VA',
                'Executive': 'Executive Assistant (EA)',
                'E-commerce': 'E-commerce Specialist',
                'WebDev': 'Web Developer',
                'General Tasks': 'General/Mixed Assistant'
            };
            
            const vaColorMapping = {
                'Administrative Assistant': 'text-td-primary',
                'Bookkeeper / AR Specialist': 'text-td-secondary',
                'Customer Service VA': 'text-td-pink',
                'Graphic Designer': 'text-td-orange',
                'Marketing VA': 'text-td-orange',
                'Executive Assistant (EA)': 'text-td-primary',
                'E-commerce Specialist': 'text-td-pink',
                'Web Developer': 'text-td-secondary',
                'General/Mixed Assistant': 'text-gray-400',
            };

            const form = document.getElementById('va-assessment-form');
            const checkboxes = document.querySelectorAll('.task-checkbox');
            const otherTaskInput = document.querySelector('input[name="Other_Tasks_Details"]');
            const totalHoursEl = document.getElementById('total-hours');
            const vaCommitmentEl = document.getElementById('va-commitment');
            const vaTypeEl = document.getElementById('va-type');
            const summaryInput = document.getElementById('summary-report-input');
            
            // Collect all possible color classes used by the recommendation boxes
            const allColorClasses = Object.values(vaColorMapping).join(' ') + ' text-td-primary text-td-secondary text-td-pink text-td-orange text-gray-400';

            function removeAllColors(element) {
                // Remove all classes that might interfere with the color application
                element.className = element.className.split(' ').filter(c => !c.startsWith('text-')).join(' ');
            }

            function updateRecommendation() {
                let totalHours = 0;
                const categoryHours = {};

                checkboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        const hours = parseInt(checkbox.getAttribute('data-hours'));
                        const category = checkbox.getAttribute('data-category');
                        
                        totalHours += hours;
                        categoryHours[category] = (categoryHours[category] || 0) + hours;
                    }
                });

                // --- 1. Update Hours and Commitment (UI) ---
                totalHoursEl.textContent = totalHours;

                let commitment = 'N/A';
                
                // Clear existing commitment color classes explicitly
                removeAllColors(vaCommitmentEl);

                if (totalHours >= 30) {
                    commitment = 'Full-Time VA';
                    vaCommitmentEl.classList.add('text-td-primary');
                } else if (totalHours >= 10) {
                    commitment = 'Part-Time VA';
                    vaCommitmentEl.classList.add('text-td-secondary');
                } else {
                    commitment = 'N/A';
                    vaCommitmentEl.classList.add('text-gray-400');
                }
                vaCommitmentEl.textContent = commitment;

                // --- 2. Determine VA Type (UI) ---
                let topCategoryKey = 'General Tasks';
                let maxHours = 0;
                
                if (totalHours > 0) {
                    for (const category in categoryHours) {
                        if (categoryHours[category] > maxHours) {
                            maxHours = categoryHours[category];
                            topCategoryKey = category;
                        }
                    }
                }
                
                const vaTypeDisplayName = vaTypeMapping[topCategoryKey] || 'General/Mixed Assistant';
                vaTypeEl.textContent = vaTypeDisplayName;

                // Clear existing VA Type color classes explicitly
                removeAllColors(vaTypeEl);

                const typeColor = vaColorMapping[vaTypeDisplayName] || 'text-gray-400';
                vaTypeEl.classList.add(typeColor);
                
                // --- 3. Prepare Hidden Form Summary ---
                const checkedTasks = Array.from(checkboxes)
                    .filter(c => c.checked)
                    .map(c => {
                        let taskName = c.value;
                        const hours = c.getAttribute('data-hours');
                        
                        if (c.id === 'other-task-checkbox' && c.checked) {
                            const details = otherTaskInput.value ? otherTaskInput.value : 'No details specified';
                            taskName = `Admin: Other Tasks (Details: ${details})`;
                        }
                        return `${taskName.split(': ')[1] || taskName} [${hours} hrs]`;
                    }).join(' | ');

                const summaryReport = `Recommendation: ${vaTypeDisplayName}, Commitment: ${commitment}, Total Hours: ${totalHours}. Checked Tasks: [${checkedTasks}]`;
                
                summaryInput.value = summaryReport;
            }

            // Attach event listeners to update UI/Form values
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', updateRecommendation);
            });

            // Listen to changes in the "Other Tasks" text input as well
            if (otherTaskInput) {
                otherTaskInput.addEventListener('input', updateRecommendation);
                document.getElementById('other-task-checkbox').addEventListener('change', updateRecommendation);
            }

            // Initial check on load
            updateRecommendation();
        });
    </script>
</body>
</html>
